
  0%|                                                                                                                                                                                                                               | 0/1300 [00:00<?, ?it/s]/home/clark/anaconda3/envs/musecoco/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


















































































































































































































































































































































































































































































































 38%|█████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                 | 500/1300 [41:53<1:07:08,  5.04s/it][INFO|trainer.py:710] 2024-07-04 18:11:31,706 >> The following columns in the evaluation set don't have a corresponding argument in `BertForAttributModel.forward` and have been ignored: text. If text are not expected by `BertForAttributModel.forward`,  you can safely ignore this message.
[INFO|trainer.py:2964] 2024-07-04 18:11:31,709 >> ***** Running Evaluation *****
[INFO|trainer.py:2966] 2024-07-04 18:11:31,709 >>   Num examples = 5000
[INFO|trainer.py:2969] 2024-07-04 18:11:31,709 >>   Batch size = 24
  1%|██                                                                                                                                                                                                                      | 2/209 [00:00<01:00,  3.45it/s]




























































 38%|█████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                 | 500/1300 [43:56<1:07:08,  5.04s/it][INFO|trainer.py:2709] 2024-07-04 18:13:35,448 >> Saving model checkpoint to ./tmp/checkpoint-500
[INFO|configuration_utils.py:453] 2024-07-04 18:13:35,449 >> Configuration saved in ./tmp/checkpoint-500/config.json
{'eval_loss': 2.428644895553589, 'eval_acc': {'I1s2_piano': 0.9972, 'I1s2_keyboard': 0.9736, 'I1s2_percussion': 0.9948, 'I1s2_organ': 0.9962, 'I1s2_guitar': 0.9974, 'I1s2_bass': 0.9976, 'I1s2_violin': 0.9872, 'I1s2_viola': 0.9904, 'I1s2_cello': 0.9908, 'I1s2_harp': 0.992, 'I1s2_strings': 0.998, 'I1s2_voice': 0.9966, 'I1s2_trumpet': 0.9784, 'I1s2_trombone': 0.9914, 'I1s2_tuba': 0.9892, 'I1s2_horn': 0.9958, 'I1s2_brass': 0.9812, 'I1s2_sax': 0.9862, 'I1s2_oboe': 0.9872, 'I1s2_bassoon': 0.9934, 'I1s2_clarinet': 0.9888, 'I1s2_piccolo': 0.9894, 'I1s2_flute': 0.9946, 'I1s2_pipe': 0.9836, 'I1s2_synthesizer': 0.9966, 'I1s2_ethnic_instruments': 0.987, 'I1s2_sound_effects': 0.9954, 'I1s2_drum': 0.9976, 'R1': 0.9816, 'R3': 0.9934, 'S2s1': 0.9772, 'S4_new_age': 0.998, 'S4_electronic': 0.997, 'S4_rap': 0.9926, 'S4_religious': 0.9836, 'S4_international': 0.9812, 'S4_easy_listening': 0.996, 'S4_avant_garde': 1.0, 'S4_rnb': 0.9976, 'S4_latin': 0.996, 'S4_children': 0.987, 'S4_jazz': 0.998, 'S4_classical': 0.9978, 'S4_comedy_spoken': 0.9962, 'S4_pop_rock': 0.9966, 'S4_reggae': 0.9938, 'S4_stage': 0.9966, 'S4_folk': 0.9958, 'S4_blues': 0.9974, 'S4_vocal': 0.975, 'S4_holiday': 0.9964, 'S4_country': 0.9976, 'S4_symphony': 0.988, 'B1s1': 0.9794, 'TS1s1': 0.9642, 'K1': 0.9998, 'T1s1': 0.9982, 'P4': 0.907, 'EM1': 0.998, 'TM1': 0.9748}, 'eval_runtime': 123.7367, 'eval_samples_per_second': 40.408, 'eval_steps_per_second': 1.689, 'epoch': 19.23}
[INFO|modeling_utils.py:1704] 2024-07-04 18:13:36,812 >> Model weights saved in ./tmp/checkpoint-500/pytorch_model.bin
[INFO|tokenization_utils_base.py:2160] 2024-07-04 18:13:36,813 >> tokenizer config file saved in ./tmp/checkpoint-500/tokenizer_config.json
[INFO|tokenization_utils_base.py:2167] 2024-07-04 18:13:36,813 >> Special tokens file saved in ./tmp/checkpoint-500/special_tokens_map.json
/home/clark/anaconda3/envs/musecoco/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '


















































































































































































































































































































































































































































































































 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 1000/1300 [1:25:53<25:00,  5.00s/it][INFO|trainer.py:710] 2024-07-04 18:55:32,293 >> The following columns in the evaluation set don't have a corresponding argument in `BertForAttributModel.forward` and have been ignored: text. If text are not expected by `BertForAttributModel.forward`,  you can safely ignore this message.
[INFO|trainer.py:2964] 2024-07-04 18:55:32,296 >> ***** Running Evaluation *****
[INFO|trainer.py:2966] 2024-07-04 18:55:32,296 >>   Num examples = 5000
[INFO|trainer.py:2969] 2024-07-04 18:55:32,296 >>   Batch size = 24
{'loss': 1.4286, 'learning_rate': 2.307692307692308e-06, 'epoch': 38.46}




























































 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 1000/1300 [1:27:57<25:00,  5.00s/it][INFO|trainer.py:2709] 2024-07-04 18:57:36,225 >> Saving model checkpoint to ./tmp/checkpoint-1000
[INFO|configuration_utils.py:453] 2024-07-04 18:57:36,225 >> Configuration saved in ./tmp/checkpoint-1000/config.json
{'eval_loss': 0.4986507296562195, 'eval_acc': {'I1s2_piano': 0.9972, 'I1s2_keyboard': 1.0, 'I1s2_percussion': 0.9994, 'I1s2_organ': 0.9988, 'I1s2_guitar': 0.9996, 'I1s2_bass': 0.9986, 'I1s2_violin': 1.0, 'I1s2_viola': 0.9982, 'I1s2_cello': 0.9986, 'I1s2_harp': 0.9962, 'I1s2_strings': 0.998, 'I1s2_voice': 0.9986, 'I1s2_trumpet': 0.9998, 'I1s2_trombone': 0.9996, 'I1s2_tuba': 0.9996, 'I1s2_horn': 0.9998, 'I1s2_brass': 1.0, 'I1s2_sax': 0.9984, 'I1s2_oboe': 0.9998, 'I1s2_bassoon': 0.9996, 'I1s2_clarinet': 0.9998, 'I1s2_piccolo': 0.9994, 'I1s2_flute': 0.9982, 'I1s2_pipe': 0.998, 'I1s2_synthesizer': 0.9976, 'I1s2_ethnic_instruments': 0.997, 'I1s2_sound_effects': 0.9994, 'I1s2_drum': 0.998, 'R1': 0.9996, 'R3': 1.0, 'S2s1': 0.9812, 'S4_new_age': 0.9988, 'S4_electronic': 0.9978, 'S4_rap': 0.9974, 'S4_religious': 0.998, 'S4_international': 0.9984, 'S4_easy_listening': 0.9966, 'S4_avant_garde': 1.0, 'S4_rnb': 0.9978, 'S4_latin': 0.9968, 'S4_children': 0.9976, 'S4_jazz': 0.998, 'S4_classical': 0.9978, 'S4_comedy_spoken': 0.999, 'S4_pop_rock': 0.9972, 'S4_reggae': 0.998, 'S4_stage': 0.9966, 'S4_folk': 0.9978, 'S4_blues': 0.999, 'S4_vocal': 0.998, 'S4_holiday': 0.9986, 'S4_country': 0.9992, 'S4_symphony': 0.9976, 'B1s1': 0.9926, 'TS1s1': 0.9888, 'K1': 1.0, 'T1s1': 1.0, 'P4': 0.9682, 'EM1': 1.0, 'TM1': 1.0}, 'eval_runtime': 123.9263, 'eval_samples_per_second': 40.347, 'eval_steps_per_second': 1.686, 'epoch': 38.46}
[INFO|modeling_utils.py:1704] 2024-07-04 18:57:37,584 >> Model weights saved in ./tmp/checkpoint-1000/pytorch_model.bin
[INFO|tokenization_utils_base.py:2160] 2024-07-04 18:57:37,585 >> tokenizer config file saved in ./tmp/checkpoint-1000/tokenizer_config.json
[INFO|tokenization_utils_base.py:2167] 2024-07-04 18:57:37,585 >> Special tokens file saved in ./tmp/checkpoint-1000/special_tokens_map.json
/home/clark/anaconda3/envs/musecoco/lib/python3.8/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '










































































































































































































































































































100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 1299/1300 [1:53:04<00:04,  4.99s/it]
{'train_runtime': 6794.4852, 'train_samples_per_second': 36.795, 'train_steps_per_second': 0.191, 'train_loss': 5.950269904503456, 'epoch': 49.99}
***** train metrics *****
  epoch                    =      49.99
  train_loss               =     5.9503
  train_perplexity         =   383.8569
  train_runtime            = 1:53:14.48
  train_samples            =       5000
  train_samples_per_second =     36.795
  train_steps_per_second   =      0.191
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1300/1300 [1:53:09<00:00,  5.00s/it][INFO|trainer.py:1901] 2024-07-04 19:22:48,025 >>
Training completed. Do not forget to share your model on huggingface.co/models =)
[INFO|trainer.py:2025] 2024-07-04 19:22:48,026 >> Loading best model from ./tmp/checkpoint-1000 (score: 0.4986507296562195).
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1300/1300 [1:53:10<00:00,  5.22s/it]
[INFO|trainer.py:710] 2024-07-04 19:22:48,755 >> The following columns in the evaluation set don't have a corresponding argument in `BertForAttributModel.forward` and have been ignored: text. If text are not expected by `BertForAttributModel.forward`,  you can safely ignore this message.
[INFO|trainer.py:2964] 2024-07-04 19:22:48,758 >> ***** Running Evaluation *****
[INFO|trainer.py:2966] 2024-07-04 19:22:48,758 >>   Num examples = 5000
[INFO|trainer.py:2969] 2024-07-04 19:22:48,758 >>   Batch size = 24





























































100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 208/209 [02:02<00:00,  1.71it/s]
***** Eval metrics *****
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 209/209 [02:03<00:00,  1.75it/s][WARNING|integrations.py:631] 2024-07-04 19:24:52,430 >> Trainer is attempting to log a value of "{'I1s2_piano': 0.9972, 'I1s2_keyboard': 1.0, 'I1s2_percussion': 0.9994, 'I1s2_organ': 0.9988, 'I1s2_guitar': 0.9996, 'I1s2_bass': 0.9986, 'I1s2_violin': 1.0, 'I1s2_viola': 0.9982, 'I1s2_cello': 0.9986, 'I1s2_harp': 0.9962, 'I1s2_strings': 0.998, 'I1s2_voice': 0.9986, 'I1s2_trumpet': 0.9998, 'I1s2_trombone': 0.9996, 'I1s2_tuba': 0.9996, 'I1s2_horn': 0.9998, 'I1s2_brass': 1.0, 'I1s2_sax': 0.9984, 'I1s2_oboe': 0.9998, 'I1s2_bassoon': 0.9996, 'I1s2_clarinet': 0.9998, 'I1s2_piccolo': 0.9994, 'I1s2_flute': 0.9982, 'I1s2_pipe': 0.998, 'I1s2_synthesizer': 0.9976, 'I1s2_ethnic_instruments': 0.997, 'I1s2_sound_effects': 0.9994, 'I1s2_drum': 0.998, 'R1': 0.9996, 'R3': 1.0, 'S2s1': 0.9812, 'S4_new_age': 0.9988, 'S4_electronic': 0.9978, 'S4_rap': 0.9974, 'S4_religious': 0.998, 'S4_international': 0.9984, 'S4_easy_listening': 0.9966, 'S4_avant_garde': 1.0, 'S4_rnb': 0.9978, 'S4_latin': 0.9968, 'S4_children': 0.9976, 'S4_jazz': 0.998, 'S4_classical': 0.9978, 'S4_comedy_spoken': 0.999, 'S4_pop_rock': 0.9972, 'S4_reggae': 0.998, 'S4_stage': 0.9966, 'S4_folk': 0.9978, 'S4_blues': 0.999, 'S4_vocal': 0.998, 'S4_holiday': 0.9986, 'S4_country': 0.9992, 'S4_symphony': 0.9976, 'B1s1': 0.9926, 'TS1s1': 0.9888, 'K1': 1.0, 'T1s1': 1.0, 'P4': 0.9682, 'EM1': 1.0, 'TM1': 1.0}" of type <class 'dict'> for key "eval/acc" as a scalar. This invocation of Tensorboard's writer.add_scalar() is incorrect so we dropped this attribute.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 209/209 [02:03<00:00,  1.70it/s]